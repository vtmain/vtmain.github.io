---
title: 应用程序单一实例运行
toc: false
date: 2017-05-17 12:19:08
updated: 2017-05-17 12:19:08
description:
tags:
categories: [Windows]
---

windows应用程序开发中会有这样的需求场景，保证任意时刻只有一个实例在运行。  
针对这种需求一般有几种方案:
1. 开启守护进程
2. 内核通知，比如命名内核对象
3. 共享数据段
4. 遍历进程，查找同属性进程
5. 若是窗口程序，判断窗口属性(类型，名称等)

<!-- more -->

我比较常用的方式是`3. 共享数据段`，下面就几种方式做简要说明
- 开启守护进程  
创建另外一个进程来监控，具体API不说了，createProcess之类的  

- 内核通知  
这里要用到内核对象，一般像`Mutex`、`Event`、`Semaphore`大家都用来做线程同步，这里也可以利用其"全局唯一"的属性，用来保证应用程序单一实例。  
> 内核对象在创建时可以指定名称，这样创建出来的叫做命名对象  
> 以上3中对象都可以命名  
> `Mutex` 有两种类型：未命名的局部mutex 和 已命名的系统mutex  
> - 局部mutex仅存在于进程内，每个未命名的mutex都表示一个单独的局部mutex  
> - 系统mutex在整个OS范围内可见，可用于进程间的活动  
> 
> `Event`/`Semaphore`  命名和未命名区别大致同上，创建时可传入名称参数lpName，可用于进程间的活动  

- **共享数据段**  
这个着重说一下
